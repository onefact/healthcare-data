-- SQL model for syhdr_commercial_person_2016.CSV
{{ config(materialized='external', location=var('output_path') + '/' + this.name + '.parquet') }}

SELECT
    PERSON_ID::UBIGINT AS PERSON_ID,
    PERSON_WGHT::NUMERIC AS PERSON_WGHT,
    AGE_LOW::NUMERIC AS AGE_LOW,
    AGE_HIGH::NUMERIC AS AGE_HIGH,
    SEX_IDENT_CD::UBIGINT AS SEX_IDENT_CD,
    STATE_CD::VARCHAR AS STATE_CD,
    COUNTY_FIPS_CD::VARCHAR AS COUNTY_FIPS_CD,
    ZIP_CD::VARCHAR AS ZIP_CD,
    PHRMCY_CVRG_1::NUMERIC AS PHRMCY_CVRG_1,
    PHRMCY_CVRG_2::NUMERIC AS PHRMCY_CVRG_2,
    PHRMCY_CVRG_3::NUMERIC AS PHRMCY_CVRG_3,
    PHRMCY_CVRG_4::NUMERIC AS PHRMCY_CVRG_4,
    PHRMCY_CVRG_5::NUMERIC AS PHRMCY_CVRG_5,
    PHRMCY_CVRG_6::NUMERIC AS PHRMCY_CVRG_6,
    PHRMCY_CVRG_7::NUMERIC AS PHRMCY_CVRG_7,
    PHRMCY_CVRG_8::NUMERIC AS PHRMCY_CVRG_8,
    PHRMCY_CVRG_9::NUMERIC AS PHRMCY_CVRG_9,
    PHRMCY_CVRG_10::NUMERIC AS PHRMCY_CVRG_10,
    PHRMCY_CVRG_11::NUMERIC AS PHRMCY_CVRG_11,
    PHRMCY_CVRG_12::NUMERIC AS PHRMCY_CVRG_12,
    CMRCL_INSRC_1::NUMERIC AS CMRCL_INSRC_1,
    CMRCL_INSRC_2::NUMERIC AS CMRCL_INSRC_2,
    CMRCL_INSRC_3::NUMERIC AS CMRCL_INSRC_3,
    CMRCL_INSRC_4::NUMERIC AS CMRCL_INSRC_4,
    CMRCL_INSRC_5::NUMERIC AS CMRCL_INSRC_5,
    CMRCL_INSRC_6::NUMERIC AS CMRCL_INSRC_6,
    CMRCL_INSRC_7::NUMERIC AS CMRCL_INSRC_7,
    CMRCL_INSRC_8::NUMERIC AS CMRCL_INSRC_8,
    CMRCL_INSRC_9::NUMERIC AS CMRCL_INSRC_9,
    CMRCL_INSRC_10::NUMERIC AS CMRCL_INSRC_10,
    CMRCL_INSRC_11::NUMERIC AS CMRCL_INSRC_11,
    CMRCL_INSRC_12::NUMERIC AS CMRCL_INSRC_12

FROM read_csv('~/data/syh_dr/syhdr_commercial_person_2016.CSV', header=True, null_padding=true, types={ 'PERSON_ID': 'UBIGINT', 'PERSON_WGHT': 'NUMERIC', 'AGE_LOW': 'NUMERIC', 'AGE_HIGH': 'NUMERIC', 'SEX_IDENT_CD': 'UBIGINT', 'STATE_CD': 'VARCHAR', 'COUNTY_FIPS_CD': 'VARCHAR', 'ZIP_CD': 'VARCHAR', 'PHRMCY_CVRG_1': 'NUMERIC', 'PHRMCY_CVRG_2': 'NUMERIC', 'PHRMCY_CVRG_3': 'NUMERIC', 'PHRMCY_CVRG_4': 'NUMERIC', 'PHRMCY_CVRG_5': 'NUMERIC', 'PHRMCY_CVRG_6': 'NUMERIC', 'PHRMCY_CVRG_7': 'NUMERIC', 'PHRMCY_CVRG_8': 'NUMERIC', 'PHRMCY_CVRG_9': 'NUMERIC', 'PHRMCY_CVRG_10': 'NUMERIC', 'PHRMCY_CVRG_11': 'NUMERIC', 'PHRMCY_CVRG_12': 'NUMERIC', 'CMRCL_INSRC_1': 'NUMERIC', 'CMRCL_INSRC_2': 'NUMERIC', 'CMRCL_INSRC_3': 'NUMERIC', 'CMRCL_INSRC_4': 'NUMERIC', 'CMRCL_INSRC_5': 'NUMERIC', 'CMRCL_INSRC_6': 'NUMERIC', 'CMRCL_INSRC_7': 'NUMERIC', 'CMRCL_INSRC_8': 'NUMERIC', 'CMRCL_INSRC_9': 'NUMERIC', 'CMRCL_INSRC_10': 'NUMERIC', 'CMRCL_INSRC_11': 'NUMERIC', 'CMRCL_INSRC_12': 'NUMERIC' }, ignore_errors=true)

